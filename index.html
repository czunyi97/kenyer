<!DOCTYPE html>
<html lang="hu">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Keny√©r Kalkul√°tor</title>
  <script src="https://kit.fontawesome.com/a076d05399.js" crossorigin="anonymous"></script>
  <style>
    body { font-family: Arial, sans-serif; background:#fceabb; display:flex; justify-content:center; align-items:center; min-height:100vh; margin:0;}
    .calculator { background:#fff; padding:20px; border-radius:15px; width:95%; max-width:480px; text-align:center;}
    label { display:block; text-align:left; margin-top:10px; font-weight:bold;}
    select, input { width:100%; padding:10px; margin-bottom:10px; border-radius:8px; border:1px solid #ccc;}
    button { width:48%; padding:12px; margin:1%; font-weight:bold; border:none; border-radius:10px; color:#fff; cursor:pointer;}
    .calculate-btn{background:#27ae60;} .calculate-btn:hover{background:#2ecc71;}
    .reset-btn{background:#e74c3c;} .reset-btn:hover{background:#ff6666;}
    .result { background:#fdf3e7; padding:15px; border-radius:10px; margin-top:15px; text-align:left;}
    .ingredient { margin:5px 0;}
  </style>
</head>
<body>
  <div class="calculator">
    <h1>ü•ñ Keny√©r Kalkul√°tor</h1>
    <label for="type">Keny√©r t√≠pusa:</label>
    <select id="type"></select>
    
    <label for="mode">Kov√°sz / √âleszt≈ë:</label>
    <select id="mode">
      <option value="kovasz">Kov√°szos</option>
      <option value="eleszto">√âleszt≈ës</option>
    </select>

    <label for="flour">Liszt mennyis√©ge (g):</label>
    <input type="number" id="flour" value="400">

    <div style="display:flex; justify-content: space-between;">
      <button class="calculate-btn" onclick="calculate()">Sz√°mol√°s</button>
      <button class="reset-btn" onclick="resetCalculator()">Reset</button>
    </div>

    <div class="result" id="result"></div>
  </div>

  <script>
    let recipes = [];

    async function loadRecipes(){
      try {
        const response = await fetch("recipes.json");
        recipes = await response.json();
        populateSelect();
      } catch(e){
        console.error("Hiba a JSON bet√∂lt√©s√©n√©l:", e);
      }
    }

    function populateSelect(){
      const typeSelect = document.getElementById("type");
      recipes.forEach(r=>{
        const option = document.createElement("option");
        option.value = r.id;
        option.textContent = r.name;
        typeSelect.appendChild(option);
      });
    }

    function calculate(){
      const type = document.getElementById("type").value;
      const mode = document.getElementById("mode").value;
      const flourInput = parseFloat(document.getElementById("flour").value);

      const recipe = recipes.find(r=>r.id===type);
      if(!recipe) return;

      let output = `<h2>üìã Recept adatok</h2>`;
      let totalWeight = 0;

      // Liszt √∂sszesz√°mol√°sa
      for(const [flourType, ratio] of Object.entries(recipe.flour)){
        const amount = Math.round(flourInput * ratio);
        totalWeight += amount;
        output += `<p class="ingredient"><b>${flourType}:</b> ${amount} g</p>`;
      }

      // Hozz√°val√≥k √∂sszesz√°mol√°sa
      const data = recipe[mode];
      for(const [key, value] of Object.entries(data)){
        const amount = value < 1 ? Math.round(flourInput * value) : Math.round(value);
        totalWeight += amount;
        output += `<p class="ingredient"><b>${key}:</b> ${amount} g</p>`;
      }

      output += `<h3>‚öñÔ∏è Teljes nyers t√©szta s√∫lya: ${totalWeight} g</h3>`;
      const bakedWeight = Math.round(totalWeight * 0.88);
      output += `<h3>‚öñÔ∏è V√°rhat√≥ kis√ºlt s√∫ly: ${bakedWeight} g</h3>`;

      if(recipe.technologia){
        output += `<h4>‚öôÔ∏è Technol√≥giai adatok:</h4><p>${recipe.technologia}</p>`;
      }

      document.getElementById("result").innerHTML = output;
    }

    function resetCalculator(){
      document.getElementById("flour").value = "";
      document.getElementById("result").innerHTML = "";
    }

    loadRecipes();
  </script>
</body>
</html>