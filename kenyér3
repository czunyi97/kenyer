<!DOCTYPE html>
<html lang="hu">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Keny√©r Kalkul√°tor</title>
  <script src="https://kit.fontawesome.com/a076d05399.js" crossorigin="anonymous"></script>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      margin: 0; padding: 0;
      background: linear-gradient(to bottom right, #fceabb, #f8b500);
      display: flex; justify-content: center; align-items: flex-start;
      min-height: 100vh; padding: 20px 0;
    }

    .calculator {
      background: #fff;
      padding: 25px;
      border-radius: 20px;
      box-shadow: 0 10px 25px rgba(0,0,0,0.25);
      width: 95%;
      max-width: 500px;
      text-align: center;
      transition: all 0.3s ease;
    }

    h1 { color: #5a3e2b; margin-bottom: 20px; font-size: 2em; }

    label { display:block; text-align:left; font-weight:bold; margin-top:15px; margin-bottom:5px; color:#5a3e2b; }

    select, input {
      width: 100%; padding: 14px; font-size: 16px;
      border-radius: 10px; border: 1px solid #ccc; margin-bottom: 15px; box-sizing:border-box;
    }

    button {
      width: 48%; padding: 14px; font-size: 18px; border:none; border-radius: 12px; cursor:pointer;
      margin:5px 1%; font-weight:bold; color:#fff; transition: all 0.2s ease-in-out;
    }

    .calculate-btn { background-color: #27ae60; }
    .calculate-btn:hover { background-color: #2ecc71; transform: translateY(-2px); }

    .reset-btn { background-color: #e74c3c; }
    .reset-btn:hover { background-color: #ff6666; transform: translateY(-2px); }

    .result { margin-top:25px; padding:20px; background:#fdf3e7; border-radius:15px; box-shadow: inset 0 0 15px rgba(0,0,0,0.05); text-align:left; transition: all 0.3s ease; }

    .ingredient { font-size: 1.1em; margin:5px 0; }
    .ingredient i { margin-right:8px; color:#f39c12; }

    .weight-bar-container { background:#ddd; border-radius:10px; width:100%; height:25px; margin-top:15px; }
    .weight-bar { background:#27ae60; height:100%; width:0; border-radius:10px; text-align:right; color:#fff; font-weight:bold; padding-right:5px; line-height:25px; transition: width 1s ease-in-out; }

    .steps { margin-top:20px; }
    .step { padding:10px 15px; border-left: 5px solid #27ae60; margin-bottom:10px; opacity:0; transform: translateX(-50px); transition: all 0.5s ease-in-out; }
    .step.show { opacity:1; transform: translateX(0); }

    @media (max-width: 480px) {
      h1 { font-size:1.7em; }
      button { font-size:16px; padding:12px; }
      select, input { font-size:15px; padding:12px; }
    }
  </style>
</head>
<body>
  <div class="calculator">
    <h1>ü•ñ Keny√©r Kalkul√°tor</h1>

    <label for="type">Keny√©r t√≠pusa:</label>
    <select id="type"></select>

    <label for="mode">Kov√°sz / √âleszt≈ë:</label>
    <select id="mode">
      <option value="kovasz">Kov√°szos</option>
      <option value="eleszto">√âleszt≈ës</option>
    </select>

    <label for="flour">Liszt mennyis√©ge (g):</label>
    <input type="number" id="flour" value="100">

    <div style="display:flex; justify-content: space-between;">
      <button class="calculate-btn" onclick="calculate()"><i class="fas fa-calculator"></i> Sz√°mol√°s</button>
      <button class="reset-btn" onclick="resetCalculator()"><i class="fas fa-undo"></i> Reset</button>
    </div>

    <div class="result" id="result">
      <div class="weight-bar-container">
        <div class="weight-bar" id="weightBar">0 g</div>
      </div>
      <div class="steps" id="steps"></div>
    </div>
  </div>

  <script>
    let recipes = [];

    async function loadRecipes() {
      const response = await fetch("recipes.json");
      recipes = await response.json();
      populateSelect();
    }

    function populateSelect() {
      const typeSelect = document.getElementById("type");
      recipes.forEach(r => {
        const option = document.createElement("option");
        option.value = r.id;
        option.textContent = r.name;
        typeSelect.appendChild(option);
      });
    }

    function calculate() {
      const type = document.getElementById("type").value;
      const mode = document.getElementById("mode").value;
      const flour = parseInt(document.getElementById("flour").value);

      const recipe = recipes.find(r => r.id === type);
      const data = recipe[mode];

      let totalWeight = flour;
      const stepsContainer = document.getElementById("steps");
      stepsContainer.innerHTML = "";

      let outputHTML = `<h2>üìã Recept adatok</h2>`;
      outputHTML += `<p class="ingredient"><i class="fas fa-bread-slice"></i> <b>Liszt:</b> ${flour} g</p>`;

      for (const [key, value] of Object.entries(data)) {
        let displayValue;
        if (typeof value === "number") {
          displayValue = value < 1 ? Math.round(flour * value) + " g" : Math.round(value) + " g";
          totalWeight += parseInt(displayValue);
        } else {
          displayValue = value;
        }

        let icon = "";
        switch(key.toLowerCase()) {
          case "v√≠z": icon="<i class='fas fa-tint'></i>"; break;
          case "kov√°sz": icon="<i class='fas fa-seedling'></i>"; break;
          case "√©leszt≈ë": icon="<i class='fas fa-leaf'></i>"; break;
          case "s√≥": icon="<i class='fas fa-snowflake'></i>"; break;
          case "cukor": icon="<i class='fas fa-candy-cane'></i>"; break;
          case "vaj": icon="<i class='fas fa-butter'></i>"; break;
          case "toj√°s": icon="<i class='fas fa-egg'></i>"; break;
          case "tej": icon="<i class='fas fa-glass-whiskey'></i>"; break;
          default: icon="<i class='fas fa-utensils'></i>";
        }

        outputHTML += `<p class="ingredient">${icon} <b>${key}:</b> ${displayValue}</p>`;
      }

      const bakedWeight = Math.round(totalWeight * 0.88);
      outputHTML += `<h3>‚öñÔ∏è V√°rhat√≥ kis√ºlt s√∫ly:</h3>`;
      outputHTML += `<p class="ingredient"><i class='fas fa-weight'></i> <b>${bakedWeight} g</b></p>`;

      document.getElementById("result").innerHTML = outputHTML + `<div class="weight-bar-container"><div class="weight-bar" id="weightBar">0 g</div></div><div class="steps" id="steps"></div>`;

      // Animate weight bar
      const bar = document.getElementById("weightBar");
      setTimeout(()=>{ bar.style.width = '100%'; bar.textContent = bakedWeight + " g"; },100);

      // Animate steps
      if(recipe.technologia) {
        const stepsArray = recipe.technologia.split(",");
        const stepsDiv = document.getElementById("steps");
        stepsArray.forEach((step, index) => {
          const stepDiv = document.createElement("div");
          stepDiv.className = "step";
          stepDiv.textContent = "‚öôÔ∏è " + step.trim();
          stepsDiv.appendChild(stepDiv);
          setTimeout(()=>{ stepDiv.classList.add("show"); }, index * 500);
        });
      }
    }

    function resetCalculator() {
      document.getElementById("flour").value = "";
      document.getElementById("result").innerHTML = `<div class="weight-bar-container"><div class="weight-bar" id="weightBar">0 g</div></div><div class="steps" id="steps"></div>`;
    }

    loadRecipes();
  </script>
</body>
</html>
